<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anthropic AI Work Patterns: Deep Dive</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-color: #151515;
            --card-bg: #1e1e1e;
            --text-main: #ebebeb;
            --text-muted: #888;
            --claude-purple: #D97757; /* Anthropic Accent Tone variant */
            --claude-accent: #d4a27f;
            --chart-red: #ff6b6b;
            --chart-blue: #4dabf7;
            --chart-green: #69db7c;
            --chart-purple: #da77f2;
            --chart-yellow: #fcc419;
            --chart-teal: #20c997;
        }

        body {
            font-family: 'Untitled Sans', 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 40px;
            overflow-x: hidden;
        }

        h1 {
            font-weight: 400;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            letter-spacing: -0.05em;
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto 40px auto;
            border-bottom: 1px solid #333;
            padding-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: end;
        }

        .tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .tab-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 1.1rem;
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab-btn:hover { color: var(--text-main); }

        .tab-btn.active {
            color: var(--claude-accent);
            border-bottom: 2px solid var(--claude-accent);
        }

        /* Grid Layout */
        .dashboard-grid {
            display: none; /* Hidden by default */
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            max-width: 1600px;
            margin: 0 auto;
            animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .dashboard-grid.active { display: grid; }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Card Styling */
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #333;
            display: flex;
            flex-direction: column;
            position: relative;
            height: 380px;
            overflow: hidden;
        }

        .card h3 {
            margin: 0 0 10px 0;
            font-size: 1rem;
            font-weight: 500;
            color: var(--claude-accent);
        }

        .card p {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin: 0 0 20px 0;
            line-height: 1.4;
            height: 40px;
        }

        .viz-container {
            flex-grow: 1;
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Controls */
        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: rgba(30, 30, 30, 0.9);
            padding: 12px 24px;
            border-radius: 30px;
            border: 1px solid #444;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .magic-btn {
            background: linear-gradient(135deg, #D97757, #C46646);
            border: none;
            color: white;
            padding: 12px 30px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(217, 119, 87, 0.3);
            transition: transform 0.2s;
        }

        .magic-btn:hover { transform: scale(1.05); }

        .status-indicator {
            font-size: 0.9rem;
            font-variant-numeric: tabular-nums;
            color: #888;
        }

        /* Specific Canvas Styling */
        canvas { width: 100% !important; height: 100% !important; }

    </style>
</head>
<body>

    <div class="header-container">
        <div>
            <h1>The Anthropic Effect</h1>
            <div style="color: #888;">Visualizing the transformation of engineering work (Before vs. After AI)</div>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('fullstack')">1. The Full-Stack Expansion</button>
        <button class="tab-btn" onclick="switchTab('speed')">2. Velocity & Feedback</button>
        <button class="tab-btn" onclick="switchTab('neglected')">3. The Long Tail</button>
    </div>

    <div id="fullstack" class="dashboard-grid active">
        <div class="card">
            <h3>The Skill Perimeter</h3>
            <p>Engineers traditionally specialize. AI pushes their competence boundary outward into Design and Ops.</p>
            <div class="viz-container"><canvas id="c1_1"></canvas></div>
        </div>
        <div class="card">
            <h3>Knowledge Neural Net</h3>
            <p>Visualizing an engineer's mental model. Isolated clusters connect into a dense mesh.</p>
            <div class="viz-container"><canvas id="c1_2_custom"></canvas></div>
        </div>
        <div class="card">
            <h3>Cross-Pollination</h3>
            <p>Security teams doing Frontend; Research doing Infra. The silos break down.</p>
            <div class="viz-container"><canvas id="c1_3"></canvas></div>
        </div>
        <div class="card">
            <h3>The "Fear" Matrix</h3>
            <p>Tasks plotted by "Unfamiliarity" vs "Action". Previously feared tasks move to "Routine".</p>
            <div class="viz-container"><canvas id="c1_4"></canvas></div>
        </div>
        <div class="card">
            <h3>Language Polyglots</h3>
            <p>Volume of code written in languages the engineer <em>does not</em> know fluently.</p>
            <div class="viz-container"><canvas id="c1_5"></canvas></div>
        </div>
        <div class="card">
            <h3>Tool Orbit</h3>
            <p>The tools an engineer commands. AI acts as gravity, pulling more tools into the engineer's orbit.</p>
            <div class="viz-container"><canvas id="c1_6_custom"></canvas></div>
        </div>
    </div>

    <div id="speed" class="dashboard-grid">
        <div class="card">
            <h3>The Autonomy Index</h3>
            <p>Claude Code tool chains vs. Human Interventions. The "Human-in-the-loop" frequency drops.</p>
            <div class="viz-container"><canvas id="c2_1"></canvas></div>
        </div>
        <div class="card">
            <h3>Time Compression Spiral</h3>
            <p>A project timeline spiraling inward. Long outer loops (Manual) tighten into fast inner loops (AI).</p>
            <div class="viz-container"><canvas id="c2_2_custom"></canvas></div>
        </div>
        <div class="card">
            <h3>Complexity vs. Speed</h3>
            <p>The "Impossible Frontier". High complexity tasks migrate to low-time quadrants.</p>
            <div class="viz-container"><canvas id="c2_3"></canvas></div>
        </div>
        <div class="card">
            <h3>The Waiting Game</h3>
            <p>Breakdown of a task. The grey "Blocked/Researching" bars vanish.</p>
            <div class="viz-container"><canvas id="c2_4"></canvas></div>
        </div>
        <div class="card">
            <h3>Context Switching Cost</h3>
            <p>Mental energy lost to switching. AI keeps context, reducing cognitive load.</p>
            <div class="viz-container"><canvas id="c2_5"></canvas></div>
        </div>
        <div class="card">
            <h3>Throughput Flow</h3>
            <p>Visualizing commits as particles. From a trickle to a steady stream.</p>
            <div class="viz-container"><canvas id="c2_6_custom"></canvas></div>
        </div>
    </div>

    <div id="neglected" class="dashboard-grid">
        <div class="card">
            <h3>The Hidden Iceberg</h3>
            <p>27% of AI work is "Net New"â€”tasks that simply wouldn't exist without AI efficiency.</p>
            <div class="viz-container"><canvas id="c3_1"></canvas></div>
        </div>
        <div class="card">
            <h3>The Backlog Swarm</h3>
            <p>P4/P5 tasks (grey dots) usually rot. AI activates them (green) and moves them to Done.</p>
            <div class="viz-container"><canvas id="c3_2_custom"></canvas></div>
        </div>
        <div class="card">
            <h3>The "Papercut" Ratio</h3>
            <p>Proportion of time spent on refactoring and quality-of-life fixes.</p>
            <div class="viz-container"><canvas id="c3_3"></canvas></div>
        </div>
        <div class="card">
            <h3>Repo Coverage Heatmap</h3>
            <p>Grid representing codebase files. Dark spots (untouched legacy code) light up.</p>
            <div class="viz-container"><canvas id="c3_4_custom"></canvas></div>
        </div>
        <div class="card">
            <h3>Task Diversity</h3>
            <p>Types of tasks completed. From "Features Only" to a balanced diet of Tests, Docs, and Tools.</p>
            <div class="viz-container"><canvas id="c3_5"></canvas></div>
        </div>
        <div class="card">
            <h3>The "Nice-to-Have" Threshold</h3>
            <p>The cost threshold for building internal tools drops below the value line.</p>
            <div class="viz-container"><canvas id="c3_6"></canvas></div>
        </div>
    </div>

    <div class="controls">
        <span class="status-indicator" id="statusText">State: <strong>Pre-AI Era</strong></span>
        <button class="magic-btn" onclick="toggleAI()">Run AI Transformation</button>
    </div>

<script>
    // --- GLOBAL STATE ---
    let isAI = false;
    let chartInstances = {};
    let animationLoops = []; // Store IDs for custom canvas loops to cancel them

    // Theme Colors
    const C_BG = '#1e1e1e';
    const C_ACCENT = '#d4a27f';
    const C_OLD = '#444';
    const C_NEW = '#D97757';
    const C_NEW_SEC = '#4dabf7';

    // Chart.js Defaults
    Chart.defaults.color = '#888';
    Chart.defaults.borderColor = '#333';
    Chart.defaults.font.family = "'Untitled Sans', system-ui";

    // --- INITIALIZATION ---
    window.onload = function() {
        initCharts();
        initCustomCanvas();
    };

    function switchTab(id) {
        // UI
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        document.querySelectorAll('.dashboard-grid').forEach(g => g.classList.remove('active'));
        document.getElementById(id).classList.add('active');

        // Restart animations for the visible tab
        stopCustomAnimations();
        initCustomCanvas();
    }

    function toggleAI() {
        isAI = !isAI;
        const btn = document.querySelector('.magic-btn');
        const txt = document.getElementById('statusText');

        if(isAI) {
            btn.innerHTML = "Revert to Manual";
            btn.style.background = "#444";
            txt.innerHTML = "State: <strong>AI Augmented</strong>";
            updateChartsAI();
        } else {
            btn.innerHTML = "Run AI Transformation";
            btn.style.background = "linear-gradient(135deg, #D97757, #C46646)";
            txt.innerHTML = "State: <strong>Pre-AI Era</strong>";
            updateChartsManual();
        }
    }

    // ============================================
    // PART 1: CHART.JS INSTANCES (Standard Charts)
    // ============================================

    function initCharts() {
        // --- PATTERN 1: FULL STACK ---

        // 1.1 Radar
        createChart('c1_1', 'radar', {
            labels: ['Backend', 'DB', 'Frontend', 'Design', 'Ops'],
            datasets: [{ label: 'Skill', data: [90, 70, 20, 10, 30], backgroundColor: 'rgba(212, 162, 127, 0.2)', borderColor: C_ACCENT }]
        });

        // 1.3 Stacked Bar
        createChart('c1_3', 'bar', {
            labels: ['Security', 'Infra', 'Research'],
            datasets: [
                { label: 'Core', data: [100, 100, 100], backgroundColor: '#555' },
                { label: 'New Domain', data: [0, 0, 0], backgroundColor: C_NEW_SEC }
            ]
        }, { scales: { x: { stacked: true }, y: { stacked: true } } });

        // 1.4 Bubble (Fear Matrix)
        createChart('c1_4', 'bubble', {
            datasets: [{
                label: 'Tasks',
                data: [{x: 80, y: 10, r: 10}, {x: 90, y: 5, r: 8}, {x: 20, y: 90, r: 15}], // x: Unfamiliarity, y: Frequency
                backgroundColor: C_OLD
            }]
        }, { scales: { x: { title: {display:true, text:'Unfamiliarity'}}, y: { title: {display:true, text:'Frequency'}} } });

        // 1.5 Polar Area
        createChart('c1_5', 'polarArea', {
            labels: ['Python', 'Go', 'Rust', 'JS/TS', 'SQL'],
            datasets: [{ data: [80, 20, 0, 5, 10], backgroundColor: [C_ACCENT, '#555', '#333', '#333', '#444'] }]
        });


        // --- PATTERN 2: SPEED ---

        // 2.1 Line
        createChart('c2_1', 'line', {
            labels: ['W1', 'W2', 'W3', 'W4'],
            datasets: [
                { label: 'AI Actions', data: [5, 5, 5, 5], borderColor: C_NEW_SEC },
                { label: 'Human Interventions', data: [10, 10, 10, 10], borderColor: C_ACCENT }
            ]
        });

        // 2.3 Scatter
        createChart('c2_3', 'scatter', {
            datasets: [{
                label: 'Features',
                data: [{x: 2, y: 10}, {x: 3, y: 15}, {x: 5, y: 30}], // x: Complexity, y: Time
                backgroundColor: C_OLD
            }]
        });

        // 2.4 Bar (Waterfall style)
        createChart('c2_4', 'bar', {
            labels: ['Research', 'Drafting', 'Debugging', 'Testing'],
            datasets: [{ label: 'Hours', data: [4, 6, 8, 4], backgroundColor: '#666' }]
        });

        // 2.5 Doughnut
        createChart('c2_5', 'doughnut', {
            labels: ['Deep Work', 'Context Switching'],
            datasets: [{ data: [60, 40], backgroundColor: [C_ACCENT, '#333'] }]
        });

        // --- PATTERN 3: NEGLECTED ---

        // 3.1 Stacked Area
        createChart('c3_1', 'line', {
            labels: ['Jan', 'Feb', 'Mar', 'Apr'],
            datasets: [
                { label: 'Core', data: [50, 50, 50, 50], fill: true, borderColor: '#555', backgroundColor: '#55555580' },
                { label: 'New', data: [0, 0, 0, 0], fill: true, borderColor: C_NEW_SEC, backgroundColor: 'rgba(77, 171, 247, 0.5)' }
            ]
        });

        // 3.3 Bar (Horizontal)
        createChart('c3_3', 'bar', {
            labels: ['Refactoring', 'Docs', 'Tooling'],
            datasets: [{ label: 'Hours/Week', data: [1, 0.5, 0], backgroundColor: '#555' }]
        }, { indexAxis: 'y' });

        // 3.5 Rose (Polar)
        createChart('c3_5', 'polarArea', {
            labels: ['Feat', 'Bug', 'Doc', 'Test', 'Tool'],
            datasets: [{ data: [80, 15, 2, 3, 0], backgroundColor: [C_NEW, '#555', '#333', '#333', '#222'] }]
        });

        // 3.6 Bar
        createChart('c3_6', 'bar', {
            labels: ['Dashboard', 'Script', 'Bot'],
            datasets: [
                { label: 'Value', data: [50, 30, 20], backgroundColor: C_NEW },
                { label: 'Cost', data: [80, 40, 60], type: 'line', borderColor: 'white' }
            ]
        });
    }

    function createChart(id, type, data, extraOpts = {}) {
        const ctx = document.getElementById(id).getContext('2d');
        chartInstances[id] = new Chart(ctx, {
            type: type,
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: extraOpts.scales || {},
                ...extraOpts
            }
        });
    }

    // ============================================
    // PART 2: DATA UPDATE LOGIC
    // ============================================

    function updateChartsAI() {
        // P1
        chartInstances['c1_1'].data.datasets[0].data = [90, 80, 70, 60, 75]; // Radar Expand
        chartInstances['c1_3'].data.datasets[1].data = [40, 30, 50]; // Stacked Bar
        chartInstances['c1_4'].data.datasets[0].data = [{x: 80, y: 60, r: 12}, {x: 90, y: 50, r: 12}, {x: 20, y: 90, r: 15}]; // Bubble Move
        chartInstances['c1_4'].data.datasets[0].backgroundColor = C_NEW_SEC;
        chartInstances['c1_5'].data.datasets[0].data = [80, 40, 30, 40, 50]; // Polyglot

        // P2
        chartInstances['c2_1'].data.datasets[0].data = [5, 12, 18, 25]; // AI Actions Up
        chartInstances['c2_1'].data.datasets[1].data = [10, 8, 5, 3]; // Human Down
        chartInstances['c2_3'].data.datasets[0].data = [{x: 2, y: 2}, {x: 3, y: 4}, {x: 5, y: 8}]; // Complexity scatter drop
        chartInstances['c2_3'].data.datasets[0].backgroundColor = C_NEW;
        chartInstances['c2_4'].data.datasets[0].data = [1, 2, 3, 2]; // Waterfall shrink
        chartInstances['c2_5'].data.datasets[0].data = [90, 10]; // Doughnut

        // P3
        chartInstances['c3_1'].data.datasets[1].data = [10, 20, 25, 27]; // New work
        chartInstances['c3_3'].data.datasets[0].data = [5, 4, 6]; // Refactoring Up
        chartInstances['c3_3'].data.datasets[0].backgroundColor = C_NEW_SEC;
        chartInstances['c3_5'].data.datasets[0].data = [50, 20, 15, 15, 25]; // Rose Balance
        chartInstances['c3_6'].data.datasets[1].data = [10, 5, 5]; // Cost Crash

        updateAll();
    }

    function updateChartsManual() {
        // Reset Logic (Simplified)
        chartInstances['c1_1'].data.datasets[0].data = [90, 70, 20, 10, 30];
        chartInstances['c1_3'].data.datasets[1].data = [0, 0, 0];
        chartInstances['c1_4'].data.datasets[0].data = [{x: 80, y: 10, r: 10}, {x: 90, y: 5, r: 8}, {x: 20, y: 90, r: 15}];
        chartInstances['c1_4'].data.datasets[0].backgroundColor = C_OLD;
        chartInstances['c1_5'].data.datasets[0].data = [80, 20, 0, 5, 10];

        chartInstances['c2_1'].data.datasets[0].data = [5, 5, 5, 5];
        chartInstances['c2_1'].data.datasets[1].data = [10, 10, 10, 10];
        chartInstances['c2_3'].data.datasets[0].data = [{x: 2, y: 10}, {x: 3, y: 15}, {x: 5, y: 30}];
        chartInstances['c2_3'].data.datasets[0].backgroundColor = C_OLD;
        chartInstances['c2_4'].data.datasets[0].data = [4, 6, 8, 4];
        chartInstances['c2_5'].data.datasets[0].data = [60, 40];

        chartInstances['c3_1'].data.datasets[1].data = [0, 0, 0, 0];
        chartInstances['c3_3'].data.datasets[0].data = [1, 0.5, 0];
        chartInstances['c3_3'].data.datasets[0].backgroundColor = '#555';
        chartInstances['c3_5'].data.datasets[0].data = [80, 15, 2, 3, 0];
        chartInstances['c3_6'].data.datasets[1].data = [80, 40, 60];

        updateAll();
    }

    function updateAll() {
        Object.values(chartInstances).forEach(c => c.update());
    }


    // ============================================
    // PART 3: CUSTOM XENOGRAPHIC ANIMATIONS (Canvas)
    // ============================================

    function initCustomCanvas() {
        // Determine which tab is active and run specific animations
        const activeTab = document.querySelector('.dashboard-grid.active').id;

        if (activeTab === 'fullstack') {
            runNetworkGraph('c1_2_custom');
            runOrbit('c1_6_custom');
        } else if (activeTab === 'speed') {
            runSpiral('c2_2_custom');
            runParticles('c2_6_custom');
        } else if (activeTab === 'neglected') {
            runBeeswarm('c3_2_custom');
            runHeatmap('c3_4_custom');
        }
    }

    function stopCustomAnimations() {
        animationLoops.forEach(id => cancelAnimationFrame(id));
        animationLoops = [];
    }

    // --- 1.2 Network Graph (Nodes connecting) ---
    function runNetworkGraph(canvasId) {
        const canvas = document.getElementById(canvasId);
        if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.parentElement.offsetWidth;
        const h = canvas.height = canvas.parentElement.offsetHeight;

        let nodes = [];
        for(let i=0; i<30; i++) nodes.push({x: Math.random()*w, y: Math.random()*h, vx: Math.random()-0.5, vy: Math.random()-0.5});

        function draw() {
            ctx.fillStyle = C_BG; ctx.fillRect(0,0,w,h);

            // Interaction: if AI, draw more lines
            const threshold = isAI ? 150 : 60;
            const nodeColor = isAI ? C_NEW_SEC : '#555';

            nodes.forEach(n => {
                n.x += n.vx; n.y += n.vy;
                if(n.x<0 || n.x>w) n.vx*=-1;
                if(n.y<0 || n.y>h) n.vy*=-1;
                ctx.beginPath(); ctx.arc(n.x, n.y, 3, 0, 6.28); ctx.fillStyle = nodeColor; ctx.fill();
            });

            ctx.lineWidth = 1;
            for(let i=0; i<nodes.length; i++){
                for(let j=i+1; j<nodes.length; j++){
                    let d = Math.hypot(nodes[i].x - nodes[j].x, nodes[i].y - nodes[j].y);
                    if(d < threshold) {
                        ctx.strokeStyle = isAI ? `rgba(77, 171, 247, ${1 - d/threshold})` : `rgba(85, 85, 85, ${1 - d/threshold})`;
                        ctx.beginPath(); ctx.moveTo(nodes[i].x, nodes[i].y); ctx.lineTo(nodes[j].x, nodes[j].y); ctx.stroke();
                    }
                }
            }
            animationLoops.push(requestAnimationFrame(draw));
        }
        draw();
    }

    // --- 1.6 Orbit (Tools orbiting center) ---
    function runOrbit(canvasId) {
        const canvas = document.getElementById(canvasId);
        if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.parentElement.offsetWidth;
        const h = canvas.height = canvas.parentElement.offsetHeight;
        let t = 0;

        function draw() {
            ctx.fillStyle = C_BG; ctx.fillRect(0,0,w,h);

            // Center
            ctx.beginPath(); ctx.arc(w/2, h/2, 15, 0, 6.28); ctx.fillStyle = '#fff'; ctx.fill();

            // Orbits
            const count = isAI ? 12 : 3;
            const speed = isAI ? 0.02 : 0.005;

            for(let i=0; i<count; i++) {
                let r = 40 + (i*12);
                let angle = t * (i%2==0 ? speed : -speed) + (i);
                let x = w/2 + Math.cos(angle)*r;
                let y = h/2 + Math.sin(angle)*r;

                ctx.strokeStyle = '#333'; ctx.beginPath(); ctx.arc(w/2, h/2, r, 0, 6.28); ctx.stroke();
                ctx.beginPath(); ctx.arc(x, y, 4, 0, 6.28);
                ctx.fillStyle = isAI ? C_NEW : C_ACCENT;
                ctx.fill();
            }
            t++;
            animationLoops.push(requestAnimationFrame(draw));
        }
        draw();
    }

    // --- 2.2 Spiral (Time Compression) ---
    function runSpiral(canvasId) {
        const canvas = document.getElementById(canvasId);
        if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.parentElement.offsetWidth;
        const h = canvas.height = canvas.parentElement.offsetHeight;
        let offset = 0;

        function draw() {
            ctx.fillStyle = C_BG; ctx.fillRect(0,0,w,h);

            let cx = w/2, cy = h/2;
            let coils = isAI ? 10 : 3; // More coils = tighter loops = faster
            let color = isAI ? C_NEW_SEC : C_ACCENT;

            ctx.beginPath();
            for(let i=0; i<100; i++) {
                let angle = 0.1 * i + offset;
                let r = 5 + (2 * angle);
                if(isAI) r = 5 + (0.5 * angle); // Tighter spiral

                let x = cx + Math.cos(angle) * r;
                let y = cy + Math.sin(angle) * r;
                if(i==0) ctx.moveTo(x,y);
                else ctx.lineTo(x,y);
            }
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();

            offset -= 0.1; // Animation speed
            animationLoops.push(requestAnimationFrame(draw));
        }
        draw();
    }

    // --- 2.6 Particle Flow (Throughput) ---
    function runParticles(canvasId) {
        const canvas = document.getElementById(canvasId);
        if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.parentElement.offsetWidth;
        const h = canvas.height = canvas.parentElement.offsetHeight;

        let particles = [];

        function draw() {
            // Trail effect
            ctx.fillStyle = 'rgba(30,30,30,0.2)'; ctx.fillRect(0,0,w,h);

            // Spawn rate
            let spawnRate = isAI ? 0.8 : 0.1; // Much faster spawn in AI
            if(Math.random() < spawnRate) {
                particles.push({x: 0, y: h/2 + (Math.random()*40 - 20), vx: isAI? 8:2, c: isAI?C_NEW:C_ACCENT});
            }

            particles.forEach((p, index) => {
                p.x += p.vx;
                ctx.fillStyle = p.c;
                ctx.fillRect(p.x, p.y, 4, 4);
                if(p.x > w) particles.splice(index, 1);
            });

            animationLoops.push(requestAnimationFrame(draw));
        }
        draw();
    }

    // --- 3.2 Beeswarm (Backlog) ---
    function runBeeswarm(canvasId) {
        const canvas = document.getElementById(canvasId);
        if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.parentElement.offsetWidth;
        const h = canvas.height = canvas.parentElement.offsetHeight;

        // Init 100 dots
        let dots = [];
        for(let i=0; i<100; i++) {
            dots.push({
                x: Math.random()*w,
                y: h - 20, // Start at bottom (backlog)
                targetY: h - 20,
                active: false
            });
        }

        function draw() {
            ctx.clearRect(0,0,w,h);

            // Logic: In AI mode, dots activate and move up (Completed)
            let activeCount = isAI ? 80 : 10;

            dots.forEach((d, i) => {
                if(i < activeCount) {
                    d.targetY = 50 + Math.random()*50; // Move to top
                    d.active = true;
                } else {
                    d.targetY = h - 50 + Math.random()*40; // Stay bottom
                    d.active = false;
                }

                // Lerp
                d.y += (d.targetY - d.y) * 0.05;

                ctx.fillStyle = d.active ? C_NEW_SEC : '#444';
                ctx.beginPath(); ctx.arc(d.x, d.y, 3, 0, 6.28); ctx.fill();
            });

            // Text labels
            ctx.fillStyle = '#888';
            ctx.fillText("Completed", 10, 40);
            ctx.fillText("Backlog / Neglected", 10, h-10);

            animationLoops.push(requestAnimationFrame(draw));
        }
        draw();
    }

    // --- 3.4 Heatmap (Repo Coverage) ---
    function runHeatmap(canvasId) {
        const canvas = document.getElementById(canvasId);
        if(!canvas) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.parentElement.offsetWidth;
        const h = canvas.height = canvas.parentElement.offsetHeight;

        let cols = 20, rows = 10;
        let cellW = w/cols, cellH = h/rows;

        function draw() {
            ctx.clearRect(0,0,w,h);

            for(let i=0; i<cols; i++) {
                for(let j=0; j<rows; j++) {
                    let id = i*rows + j;
                    // AI lights up random corners (legacy code)
                    let lit = false;
                    if(isAI) {
                        // Random noise logic
                        lit = Math.sin(id * 99 + Date.now()/500) > 0;
                    } else {
                        // Only center lit
                        lit = (i > 5 && i < 15 && j > 2 && j < 8);
                    }

                    ctx.fillStyle = lit ? (isAI ? C_NEW : C_ACCENT) : '#2a2a2a';
                    ctx.fillRect(i*cellW + 1, j*cellH + 1, cellW-2, cellH-2);
                }
            }
            animationLoops.push(requestAnimationFrame(draw));
        }
        draw();
    }

</script>
</body>
</html>

<!-- https://gemini.google.com/u/2/app/d79dab73d55adedc -->
